// Generated by CoffeeScript 1.4.0
(function() {
  var stateMachinePackage;

  stateMachinePackage = require('openb-app-state-machine');

  module.exports = function(processDefinition, cb) {
    var sm, smData;
    if (!processDefinition) {
      return cb(new Error("No valid process defintions found."));
    }
    smData = null;
    try {
      smData = JSON.parse(processDefinition.stateMachine);
    } catch (e) {
      console.log("Could not parse statemachine for " + processDefinition.name);
      console.log(processDefinition.stateMachine);
      return cb(new Error("Could not parse JSON State Machine for Process Defintion " + processDefinition.name));
    }
    sm = stateMachinePackage.stateMachine();
    sm.loadFromObject(smData);
    return cb(null, sm);
  };

}).call(this);
