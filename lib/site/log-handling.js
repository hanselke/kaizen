// Generated by CoffeeScript 1.4.0
(function() {
  var ansiColor, express;

  express = require('express');

  ansiColor = require('ansi-color').set;

  module.exports = function(app) {
    var pad2;
    pad2 = function(i) {
      if (i < 10) {
        return "0" + i;
      } else {
        return i;
      }
    };
    express.logger.token("short-date", function(req, res) {
      var d;
      d = new Date();
      return pad2(d.getMonth() + 1) + "." + pad2(d.getDate()) + " " + d.toTimeString().substr(0, 8);
    });
    express.logger.token("user", function(req, res) {
      if (req.user) {
        return req.user.username || req.user.primaryEmail;
      } else {
        return "No-user";
      }
    });
    express.logger.token("color-status", function(req, res) {
      var color, s;
      s = res.statusCode;
      color = "green";
      if (s >= 500) {
        color = "red";
      } else if (s >= 400) {
        color = "yellow";
      } else {
        if (s >= 300) {
          color = "cyan";
        }
      }
      return ansi_color(s, color);
    });
    return app.use(express.logger({
      format: ansiColor("[:short-date] (:remote-addr) [:user]", "white") + " :method :url - HTTP :color-status - :response-time msec"
    }));
  };

}).call(this);
