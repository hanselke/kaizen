// Generated by CoffeeScript 1.4.0

/*
Transforms raw data to the one that is sent to the client.
*/


(function() {

  module.exports = function(process, processInstances) {
    var activity, instance, participant, result, _i, _j, _k, _len, _len1, _len2, _ref, _ref1, _ref2, _ref3, _ref4, _ref5, _ref6;
    result = {
      lanes: []
    };
    _ref1 = (process != null ? (_ref = process.participants) != null ? _ref.ParticipantDefinition : void 0 : void 0) || [];
    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
      participant = _ref1[_i];
      result.lanes.push({
        label: participant.label || "",
        name: participant.name || "",
        cards: []
      });
    }
    result.lanes.push({
      label: "Done",
      name: 'done',
      cards: []
    });
    _ref2 = processInstances != null ? processInstances.ProcessInstance : void 0;
    for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
      instance = _ref2[_j];
      _ref4 = (_ref3 = instance.activities) != null ? _ref3.ActivityInstance : void 0;
      for (_k = 0, _len2 = _ref4.length; _k < _len2; _k++) {
        activity = _ref4[_k];
        result.lanes[0].cards.push({
          id: (_ref5 = activity.uuid) != null ? _ref5.value : void 0,
          desc: activity.label,
          html: activity.description,
          ready: ((_ref6 = activity.state) != null ? _ref6.toUpperCase() : void 0) === "READY",
          state: activity.state
        });
      }
    }
    return result;
  };

}).call(this);
